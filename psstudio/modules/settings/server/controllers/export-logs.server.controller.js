var a21_0x556f=["model","PsCoreConfig","../../../core/server/controllers/errors.server.controller","log","file","exportLogs","Received\x20export\x20log\x20request\x20from\x20User\x20","username","body","exportOptions","error","send","exportRouteAccessLogs","readFile","./access.log","Unable\x20to\x20export\x20Route\x20Access\x20logs","exportOSLogs","info","Received\x20export\x20OS\x20log\x20request\x20from\x20User\x20","user","Could\x20not\x20Export\x20OS\x20logs.\x20No\x20exportOptions\x20parameter\x20found\x20in\x20request\x20body","sendStatus","startDate","toISOString","replace","endDate","desc","\x20--reverse",">\x20/tmp/OSLogs.log","child_process","/tmp/OSLogs.log","Unable\x20to\x20export\x20OS\x20logs","toString","status","Repairing\x20logs","Repairing\x20logs...","readdir","forEach","indexOf",".log","npm-debug.log","length","exportPsCoreAppLogs","psScoreConfig","logFilePath","Unable\x20to\x20export\x20logs","No\x20logs\x20found\x20for\x20this\x20machine!","psCoreConfigById","Error\x20while\x20finding\x20psconfig\x20data","path","resolve"];(function(_0x165240,_0x52a7b9){var _0x43c3bc=function(_0x3f9c4e){while(--_0x3f9c4e){_0x165240["push"](_0x165240["shift"]());}};_0x43c3bc(++_0x52a7b9);}(a21_0x556f,0xca));var a21_0x4e0f=function(_0x20b090,_0x137d56){_0x20b090=_0x20b090-0x0;var _0x4899c9=a21_0x556f[_0x20b090];return _0x4899c9;};var path=require(a21_0x4e0f("0x0")),logger=require(path[a21_0x4e0f("0x1")]("./logger")),Config=mongoose[a21_0x4e0f("0x2")](a21_0x4e0f("0x3")),errorHandler=require(a21_0x4e0f("0x4"));var fs=require("fs");function exportLogs(_0x434f11,_0xec56e1){console[a21_0x4e0f("0x5")](_0x434f11);logger["query"](_0x434f11,function(_0x521312,_0x46b266){if(_0x521312){logger["error"]("Unable\x20to\x20export\x20logs",{"error":_0x521312});_0xec56e1(null);return;}_0xec56e1(_0x46b266[a21_0x4e0f("0x6")]);});}exports[a21_0x4e0f("0x7")]=function(_0x5736a9,_0x22c0b3){logger["info"](a21_0x4e0f("0x8")+_0x5736a9["user"][a21_0x4e0f("0x9")]);if(!_0x5736a9[a21_0x4e0f("0xa")][a21_0x4e0f("0xb")]){logger[a21_0x4e0f("0xc")]("Could\x20not\x20Export\x20logs.\x20No\x20exportOptions\x20parameter\x20found\x20in\x20request\x20body");_0x22c0b3["sendStatus"](0x190);return;}exportLogs(_0x5736a9[a21_0x4e0f("0xa")][a21_0x4e0f("0xb")],function(_0x24d197){if(!_0x24d197)_0x22c0b3[a21_0x4e0f("0xd")](0x1f4);else _0x22c0b3[a21_0x4e0f("0xd")](_0x24d197);});};exports[a21_0x4e0f("0xe")]=function(_0x18402a,_0x58a1a6){fs[a21_0x4e0f("0xf")](path[a21_0x4e0f("0x1")](a21_0x4e0f("0x10")),function(_0x54ce14,_0x4a7924){if(_0x54ce14){logger["error"](a21_0x4e0f("0x11"),{"error":_0x54ce14});_0x58a1a6["sendStatus"](0x1f4);return;}_0x58a1a6["send"]({"logs":_0x4a7924["toString"]()});});};exports[a21_0x4e0f("0x12")]=function(_0x2159bd,_0xd917f3){logger[a21_0x4e0f("0x13")](a21_0x4e0f("0x14")+_0x2159bd[a21_0x4e0f("0x15")][a21_0x4e0f("0x9")]);if(!_0x2159bd["body"][a21_0x4e0f("0xb")]){logger[a21_0x4e0f("0xc")](a21_0x4e0f("0x16"));_0xd917f3[a21_0x4e0f("0x17")](0x190);return;}var _0x49aef7="";var _0x1ecba1="";if(_0x2159bd[a21_0x4e0f("0xa")][a21_0x4e0f("0xb")][a21_0x4e0f("0x18")]){_0x49aef7=new Date(_0x2159bd[a21_0x4e0f("0xa")][a21_0x4e0f("0xb")][a21_0x4e0f("0x18")])[a21_0x4e0f("0x19")]();_0x49aef7=_0x49aef7["replace"](/T/,"\x20")[a21_0x4e0f("0x1a")](/\..+/,"");}if(_0x2159bd[a21_0x4e0f("0xa")][a21_0x4e0f("0xb")]["endDate"]){_0x1ecba1=new Date(_0x2159bd[a21_0x4e0f("0xa")][a21_0x4e0f("0xb")][a21_0x4e0f("0x1b")])[a21_0x4e0f("0x19")]();_0x1ecba1=_0x1ecba1[a21_0x4e0f("0x1a")](/T/,"\x20")[a21_0x4e0f("0x1a")](/\..+/,"");}var _0x2e42a3="journalctl\x20--since\x20\x22"+_0x49aef7+"\x22\x20--until\x20\x22"+_0x1ecba1+"\x22";_0x2e42a3+=_0x2159bd[a21_0x4e0f("0xa")][a21_0x4e0f("0xb")]["order"]==a21_0x4e0f("0x1c")?a21_0x4e0f("0x1d"):"";_0x2e42a3+=a21_0x4e0f("0x1e");var _0x25602a=require(a21_0x4e0f("0x1f"))["exec"];_0x25602a(_0x2e42a3,function(_0x4c13c1){if(_0x4c13c1!==null){logger[a21_0x4e0f("0xc")]("Unable\x20to\x20execute\x20OS\x20Log\x20command.\x20exec\x20error:\x20"+{"error":_0x4c13c1});_0xd917f3["sendStatus"](0x1f4);}else{fs[a21_0x4e0f("0xf")](a21_0x4e0f("0x20"),function(_0x1bb5a2,_0x56d37a){if(_0x1bb5a2){logger[a21_0x4e0f("0xc")](a21_0x4e0f("0x21"),{"error":_0x1bb5a2});_0xd917f3["sendStatus"](0x1f4);return;}_0xd917f3["send"]({"logs":_0x56d37a[a21_0x4e0f("0x22")]()});});}});};exports["repairLogs"]=function(_0xf18661,_0x4190b4){repairLogs();_0x4190b4[a21_0x4e0f("0x23")](0xc8)["send"]({"message":a21_0x4e0f("0x24")});};function repairLogs(){console["log"](a21_0x4e0f("0x25"));fs[a21_0x4e0f("0x26")]("./",function(_0x3dd151,_0x2fa987){if(_0x3dd151){console[a21_0x4e0f("0xc")](_0x3dd151);return;}_0x2fa987[a21_0x4e0f("0x27")](function(_0xadc605){if(_0xadc605[a21_0x4e0f("0x28")](a21_0x4e0f("0x29"))!=-0x1){_0x40eedc(_0xadc605);}});});function _0x40eedc(_0x321742){if(_0x321742==a21_0x4e0f("0x2a"))return;console[a21_0x4e0f("0x5")]("Repairing\x20log\x20file\x20"+_0x321742);fs["readFile"]("./"+_0x321742,function(_0x183a88,_0x3bbf1d){if(_0x183a88){console[a21_0x4e0f("0xc")](_0x183a88);return;}var _0x5bae6a=_0x3bbf1d[a21_0x4e0f("0x22")]();var _0x332e17=_0x5bae6a[a21_0x4e0f("0x1a")](/\00/g,"");if(_0x5bae6a[a21_0x4e0f("0x2b")]!=_0x332e17[a21_0x4e0f("0x2b")]){fs["writeFile"]("./"+_0x321742,_0x332e17,function(_0x183a88){if(_0x183a88)console[a21_0x4e0f("0xc")](_0x183a88);});}});}}exports[a21_0x4e0f("0x2c")]=function(_0x1c16f0,_0x1d8e87){var _0x460be9=_0x1c16f0[a21_0x4e0f("0x2d")][a21_0x4e0f("0x2e")];if(!_0x460be9){logger[a21_0x4e0f("0xc")](a21_0x4e0f("0x2f"));_0x1d8e87[a21_0x4e0f("0x23")](0x1f4)["send"]({"statusText":a21_0x4e0f("0x30")});return;}fs[a21_0x4e0f("0xf")](path["resolve"](_0x460be9),function(_0x1f1f78,_0x4b30fb){if(_0x1f1f78){logger["error"](a21_0x4e0f("0x2f"),{"error":_0x1f1f78});_0x1d8e87[a21_0x4e0f("0x17")](0x1f4);return;}_0x1d8e87["send"]({"logs":_0x4b30fb[a21_0x4e0f("0x22")]()});});};exports[a21_0x4e0f("0x31")]=function(_0xb110df,_0x5f3919,_0x25104c,_0x1d96bb){Config["findById"](_0x1d96bb)["exec"](function(_0x47a002,_0x53eb50){if(_0x47a002){logger[a21_0x4e0f("0xc")](a21_0x4e0f("0x32"),{"error":_0x47a002});return _0x25104c(_0x47a002);}else if(!_0x53eb50){return _0x5f3919[a21_0x4e0f("0x23")](0x194)["send"]({"message":"No\x20psconfig\x20with\x20that\x20identifier\x20has\x20been\x20found"});}_0xb110df[a21_0x4e0f("0x2d")]=_0x53eb50;_0x25104c();});};exports["internalFunctions"]={"exportLogs":exportLogs};