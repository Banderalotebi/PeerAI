var a11_0x5580=["save","Username\x20field\x20must\x20not\x20be\x20blank","http://","secure","ssl","https://","render","modules/users/server/templates/reset-password-email","title","headers","host","/api/auth/reset/","email","mailer","Password\x20Reset","sendMail","An\x20email\x20has\x20been\x20sent\x20to\x20the\x20provided\x20email\x20with\x20further\x20instructions.","Failure\x20sending\x20email","validateResetToken","token","redirect","/password/reset/invalid","/password/reset/","params","verifyPassword","password","newPassword","getErrorMessage","json","Password\x20reset\x20token\x20is\x20invalid\x20or\x20has\x20expired.","modules/users/server/templates/reset-password-confirm-email","displayName","app","from","Your\x20password\x20has\x20been\x20changed","done","changePassword","user","findById","authenticate","login","Password\x20changed\x20successfully","Passwords\x20do\x20not\x20match","Current\x20password\x20is\x20incorrect","User\x20is\x20not\x20signed\x20in","changePasswordByAdmin","aid","uid","Please\x20provide\x20a\x20new\x20password","User\x20is\x20not\x20found","Unauthorized\x20activity!.","path","resolve","mongoose","model","User","nodemailer","async","crypto","createTransport","options","waterfall","randomBytes","toString","hex","body","username","findOne","toLowerCase","status","send","No\x20account\x20with\x20that\x20username\x20has\x20been\x20found","provider","local","\x20account","resetPasswordToken","resetPasswordExpires","now"];(function(_0x2e9e72,_0x4fad9a){var _0x3e16c9=function(_0x3a6fb2){while(--_0x3a6fb2){_0x2e9e72["push"](_0x2e9e72["shift"]());}};_0x3e16c9(++_0x4fad9a);}(a11_0x5580,0x81));var a11_0x2b25=function(_0x2e4e91,_0xa9e967){_0x2e4e91=_0x2e4e91-0x0;var _0x36293c=a11_0x5580[_0x2e4e91];return _0x36293c;};"use strict";/**
 * Module dependencies.
 */var path=require(a11_0x2b25("0x0")),config=require(path[a11_0x2b25("0x1")]("./config/config")),errorHandler=require(path[a11_0x2b25("0x1")]("./modules/core/server/controllers/errors.server.controller")),mongoose=require(a11_0x2b25("0x2")),User=mongoose[a11_0x2b25("0x3")](a11_0x2b25("0x4")),nodemailer=require(a11_0x2b25("0x5")),async=require(a11_0x2b25("0x6")),crypto=require(a11_0x2b25("0x7"));var smtpTransport=nodemailer[a11_0x2b25("0x8")](config["mailer"][a11_0x2b25("0x9")]);exports["forgot"]=function(_0x4a59d3,_0x84fe95,_0x4feb3b){async[a11_0x2b25("0xa")]([function(_0x1fa3d2){crypto[a11_0x2b25("0xb")](0x14,function(_0x543df3,_0x268282){var _0x462dc2=_0x268282[a11_0x2b25("0xc")](a11_0x2b25("0xd"));_0x1fa3d2(_0x543df3,_0x462dc2);});},function(_0x54bffb,_0x43a67){if(_0x4a59d3[a11_0x2b25("0xe")][a11_0x2b25("0xf")]){User[a11_0x2b25("0x10")]({"username":_0x4a59d3[a11_0x2b25("0xe")][a11_0x2b25("0xf")][a11_0x2b25("0x11")]()},"-salt\x20-password",function(_0x1b826d,_0x1edde3){if(!_0x1edde3){return _0x84fe95[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":a11_0x2b25("0x14")});}else if(_0x1edde3[a11_0x2b25("0x15")]!==a11_0x2b25("0x16")){return _0x84fe95[a11_0x2b25("0x12")](0x190)["send"]({"message":"It\x20seems\x20like\x20you\x20signed\x20up\x20using\x20your\x20"+_0x1edde3[a11_0x2b25("0x15")]+a11_0x2b25("0x17")});}else{_0x1edde3[a11_0x2b25("0x18")]=_0x54bffb;_0x1edde3[a11_0x2b25("0x19")]=Date[a11_0x2b25("0x1a")]()+0x36ee80;_0x1edde3[a11_0x2b25("0x1b")](function(_0x1b826d){_0x43a67(_0x1b826d,_0x54bffb,_0x1edde3);});}});}else{return _0x84fe95[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":a11_0x2b25("0x1c")});}},function(_0x3b8c9a,_0x5a22e0,_0x565bc2){var _0xdb513d=a11_0x2b25("0x1d");if(config[a11_0x2b25("0x1e")]&&config[a11_0x2b25("0x1e")][a11_0x2b25("0x1f")]===!![]){_0xdb513d=a11_0x2b25("0x20");}_0x84fe95[a11_0x2b25("0x21")](path[a11_0x2b25("0x1")](a11_0x2b25("0x22")),{"name":_0x5a22e0["displayName"],"appName":config["app"][a11_0x2b25("0x23")],"url":_0xdb513d+_0x4a59d3[a11_0x2b25("0x24")][a11_0x2b25("0x25")]+a11_0x2b25("0x26")+_0x3b8c9a},function(_0x5f24e3,_0x51ebf1){_0x565bc2(_0x5f24e3,_0x51ebf1,_0x5a22e0);});},function(_0x109061,_0xe96405,_0x322703){var _0x95a766={"to":_0xe96405[a11_0x2b25("0x27")],"from":config[a11_0x2b25("0x28")]["from"],"subject":a11_0x2b25("0x29"),"html":_0x109061};smtpTransport[a11_0x2b25("0x2a")](_0x95a766,function(_0x1e4f4e){if(!_0x1e4f4e){_0x84fe95["send"]({"message":a11_0x2b25("0x2b")});}else{return _0x84fe95["status"](0x190)[a11_0x2b25("0x13")]({"message":a11_0x2b25("0x2c")});}_0x322703(_0x1e4f4e);});}],function(_0x23d67d){if(_0x23d67d){return _0x4feb3b(_0x23d67d);}});};exports[a11_0x2b25("0x2d")]=function(_0x1b3639,_0x3e39c4){User["findOne"]({"resetPasswordToken":_0x1b3639["params"][a11_0x2b25("0x2e")],"resetPasswordExpires":{"$gt":Date[a11_0x2b25("0x1a")]()}},function(_0x5eff38,_0x41acbc){if(!_0x41acbc){return _0x3e39c4[a11_0x2b25("0x2f")](a11_0x2b25("0x30"));}_0x3e39c4[a11_0x2b25("0x2f")](a11_0x2b25("0x31")+_0x1b3639[a11_0x2b25("0x32")]["token"]);});};exports["reset"]=function(_0x359b54,_0xa2137e,_0x1874dc){var _0x1270f5=_0x359b54[a11_0x2b25("0xe")];var _0x4ae5d0=null;async[a11_0x2b25("0xa")]([function(_0x512608){User[a11_0x2b25("0x10")]({"resetPasswordToken":_0x359b54[a11_0x2b25("0x32")]["token"],"resetPasswordExpires":{"$gt":Date["now"]()}},function(_0x4a120c,_0x3500d0){if(!_0x4a120c&&_0x3500d0){if(_0x1270f5["newPassword"]===_0x1270f5[a11_0x2b25("0x33")]){_0x3500d0[a11_0x2b25("0x34")]=_0x1270f5[a11_0x2b25("0x35")];_0x3500d0["resetPasswordToken"]=undefined;_0x3500d0["resetPasswordExpires"]=undefined;_0x3500d0[a11_0x2b25("0x1b")](function(_0x4a120c){if(_0x4a120c){return _0xa2137e[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":errorHandler[a11_0x2b25("0x36")](_0x4a120c)});}else{_0x359b54["login"](_0x3500d0,function(_0x4a120c){if(_0x4a120c){_0xa2137e["status"](0x190)[a11_0x2b25("0x13")](_0x4a120c);}else{_0x3500d0[a11_0x2b25("0x34")]=undefined;_0x3500d0["salt"]=undefined;_0xa2137e[a11_0x2b25("0x37")](_0x3500d0);_0x512608(_0x4a120c,_0x3500d0);}});}});}else{return _0xa2137e[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":"Passwords\x20do\x20not\x20match"});}}else{return _0xa2137e[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":a11_0x2b25("0x38")});}});},function(_0x51283c,_0x160bba){_0xa2137e[a11_0x2b25("0x21")](a11_0x2b25("0x39"),{"name":_0x51283c[a11_0x2b25("0x3a")],"appName":config[a11_0x2b25("0x3b")][a11_0x2b25("0x23")]},function(_0x30b4bb,_0x410649){_0x160bba(_0x30b4bb,_0x410649,_0x51283c);});},function(_0x584ed3,_0xa8d6b2,_0x3c072c){var _0x43f1ac={"to":_0xa8d6b2[a11_0x2b25("0x27")],"from":config["mailer"][a11_0x2b25("0x3c")],"subject":a11_0x2b25("0x3d"),"html":_0x584ed3};smtpTransport["sendMail"](_0x43f1ac,function(_0x10d6e7){_0x3c072c(_0x10d6e7,a11_0x2b25("0x3e"));});}],function(_0x1e132d){if(_0x1e132d){return _0x1874dc(_0x1e132d);}});};exports[a11_0x2b25("0x3f")]=function(_0x1ed4fd,_0x5ad131,_0x4481ce){var _0x14c645=_0x1ed4fd[a11_0x2b25("0xe")];var _0x1de9e2=null;if(_0x1ed4fd[a11_0x2b25("0x40")]){if(_0x14c645["newPassword"]){User[a11_0x2b25("0x41")](_0x1ed4fd[a11_0x2b25("0x40")]["id"],function(_0x380d73,_0x34fbfb){if(!_0x380d73&&_0x34fbfb){if(_0x34fbfb[a11_0x2b25("0x42")](_0x14c645["currentPassword"])){if(_0x14c645["newPassword"]===_0x14c645["verifyPassword"]){_0x34fbfb[a11_0x2b25("0x34")]=_0x14c645["newPassword"];_0x34fbfb[a11_0x2b25("0x1b")](function(_0x380d73){if(_0x380d73){return _0x5ad131[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":errorHandler["getErrorMessage"](_0x380d73)});}else{_0x1ed4fd[a11_0x2b25("0x43")](_0x34fbfb,function(_0x380d73){if(_0x380d73){_0x5ad131["status"](0x190)[a11_0x2b25("0x13")](_0x380d73);}else{_0x5ad131["send"]({"message":a11_0x2b25("0x44")});}});}});}else{_0x5ad131[a11_0x2b25("0x12")](0x190)["send"]({"message":a11_0x2b25("0x45")});}}else{_0x5ad131["status"](0x190)[a11_0x2b25("0x13")]({"message":a11_0x2b25("0x46")});}}else{_0x5ad131[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":"User\x20is\x20not\x20found"});}});}else{_0x5ad131[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":"Please\x20provide\x20a\x20new\x20password"});}}else{_0x5ad131[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":a11_0x2b25("0x47")});}};exports[a11_0x2b25("0x48")]=function(_0x77518a,_0x25fb66){var _0x3498e2=_0x77518a[a11_0x2b25("0xe")];var _0x2bcbd3=null;if(_0x3498e2[a11_0x2b25("0x49")]){User[a11_0x2b25("0x41")](_0x3498e2[a11_0x2b25("0x49")],function(_0x3bfa07,_0x24a984){if(_0x3bfa07){_0x25fb66["status"](0x190)[a11_0x2b25("0x13")]({"message":"Unauthorized\x20user!."});}else{if(_0x3498e2[a11_0x2b25("0x4a")]){if(_0x3498e2[a11_0x2b25("0x35")]){User[a11_0x2b25("0x41")](_0x3498e2[a11_0x2b25("0x4a")],function(_0x3bfa07,_0x531c74){if(!_0x3bfa07&&_0x531c74){if(_0x531c74["username"]!=_0x3498e2["userName"]){return _0x25fb66["status"](0x190)[a11_0x2b25("0x13")]({"message":"Invalid\x20username!"});}if(_0x3498e2[a11_0x2b25("0x35")]===_0x3498e2[a11_0x2b25("0x33")]){_0x531c74[a11_0x2b25("0x34")]=_0x3498e2[a11_0x2b25("0x35")];_0x531c74["save"](function(_0x3bfa07){if(_0x3bfa07){return _0x25fb66[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":errorHandler[a11_0x2b25("0x36")](_0x3bfa07)});}else{_0x25fb66[a11_0x2b25("0x13")]({"message":"Password\x20changed\x20successfully"});}});}else{_0x25fb66[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":a11_0x2b25("0x45")});}}else{_0x25fb66[a11_0x2b25("0x12")](0x190)["send"]({"message":"User\x20is\x20not\x20found"});}});}else{_0x25fb66["status"](0x190)[a11_0x2b25("0x13")]({"message":a11_0x2b25("0x4b")});}}else{_0x25fb66[a11_0x2b25("0x12")](0x190)[a11_0x2b25("0x13")]({"message":a11_0x2b25("0x4c")});}}});}else{_0x25fb66["status"](0x190)["send"]({"message":a11_0x2b25("0x4d")});}};